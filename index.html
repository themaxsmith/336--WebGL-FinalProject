<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>CS363 - Final Project</title>
        <style>
            .canvasDisplay{
                width: 100%;
                height: 100%;
                background-color: #000;
            }

            body, html {
                padding: 0;
                margin: 0;
            }
        </style>
        <script  id="vertex-shader-3d" type="x-shader/x-vertex">
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }
        </script>
        <script  id="fragment-shader-3d" type="x-shader/x-fragment">
            uniform vec3 pos;
            uniform vec4 clipRect;
            uniform sampler2D texture1;
            varying vec2 vUv;
            void main() {
                vec2 uv = vUv;
                
                vec4 tex = texture2D( texture1, uv * 9.0 );
                gl_FragColor = tex;
            }
        </script>
        <script src="https://cdn.jsdelivr.net/npm/vue@3.2.45/dist/vue.global.min.js"></script>
    </head>
    <body>
        <canvas id="canvas" class="canvasDisplay"></canvas>
        <div id="overlay">
            <!-- three views one for each demo, fire animation, sprite sheet, shader color texture  -->

            <div id="app">
                <h3>CS363 Sprites</h3>
                <!-- three radio buttons for options -->
                <div>
                 
                    <input type="radio" id="fire" name="demo" value="fire" v-model="demo">
                    <label for="fire">Sprite Animation</label>
                    <input type="radio" id="sprite" name="demo" value="sprite" v-model="demo">
                    <label for="sprite">Sprite Sheet</label>
                    <input type="radio" id="shader" name="demo" value="shader" v-model="demo">
                    <label for="shader">Shader Colored Textures</label>
                    <input type="radio" id="About" name="demo" value="About" v-model="demo">
                    <label for="About">About</label>
                </div>
                <!-- switch with each view content -->
                <div v-if="demo == 'About'">
                    <h3>Introduction</h3>
                    <p>
                        This is a demo of a few different texture techniques using custom shaders.<br />
                        The tech stack is Webpack, Vue.js, Three.js, and WebGL .<br />
                        All of the texture techniques are implemented in the custom WebGL shaders.<br />
                        We used three.js for the camera, skybox, and the floor.<br />
                        We used vue.js for the overlay UI.<br />
                        We used webpack to bundle the project and add true library and typed class support.<br />
                    </p>
                    <a href="#" onclick="window.alert('View on project root folder at ./Individual-statements.txt')">View Individual Contribution Statements</a>
                    <h5>Application Class Structure</h5>
                    <img src="/textures/CodeStruct.png" style="width:100%;   ">

                    </div>  
                <div v-if="demo == 'fire'">
                    <h2>Fire Animation</h2>
                    <div>
                        <p>
                            The Fire Animation has two parts, the first is the sprite. Sprites are a texture assigned a 2d plane and can be made to always face the camera. 
                            The second part is the animation. The animation is a series of images that are played in sequence to create the illusion of movement. The second fire showcases when a normal map is applied.
                        </p>
                        <h5>fire.png (texture1):</h5>

                        <img src="/textures/fire.png" style="width:100%;   image-rendering: pixelated; " alt="Doom Enemy Texture">
                        <h5>FireNormal.png (texture2):</h5>

                        <img src="/textures/FireNormal.png" style="width:100%;   image-rendering: pixelated; " alt="Doom Enemy Texture">
                        <h5>Vertex Shader Code:</h5>
                        <pre> 
                            <code>
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
                            </code>
                        </pre>

                        <h5>Fragment Shader Code:</h5>
                        <pre> 
                            <code>
uniform vec3 pos;
uniform vec2 spriteSelected;
uniform vec2 spriteSize;
uniform sampler2D texture1;
uniform sampler2D texture2;
varying vec2 vUv;
void main() {
    vec2 uv = vUv;
                                    
    vec4 tex = texture2D( texture1, uv / spriteSize + (spriteSelected / spriteSize) );
                    
    // if the alpha is 0, discard this fragment
    if (tex.a == 0.0) discard;
                    
    ${!withMap ? 'gl_FragColor = tex;' : ''}
                    
    // condensed color weight between rgb
    float v = tex.x + tex.y + tex.z;

    // if color near solid black, discard : removes the blocky black border
    if(v < 0.1) discard;
                    
    // if color near solid white, dampen the color by reducing slightly
    if(v > 2.9) tex.xyz*=.85;
                    
    // a texture map to reduce the blockiness/pixelation (center of fire, not edges) of original 2d image
    vec4 tex2 = texture2D( texture2, uv);
                    
    ${withMap ? 'gl_FragColor = tex/tex2;' : ''}
                                    
}
                            </code>
                        </pre>
                        <h5>Each Frame Updates:</h5>
                        <p>1. Update to look at camera<br />
                        2. Update uniform to next sprite via spriteSelected (x,y) uniform</p>

                 
                        <h5>Real World Example:</h5>
                        <p>Doom uses this concept for its enemy textures and other entities</p>
                        <img src="/textures/BjlN.gif" style="width:100%" alt="Doom Enemy Texture">
                        <h5>Sources:</h5>
                        <ul>
                            <li><a href="https://gifer.com/fr/s/game-doom">Doom in-game (From Gifer)</a></li>
                       
                        </ul> 
            </div>
        </div>
        <div v-if="demo == 'sprite'">
            <h2>Sprite Sheet</h2>
            <div>
                <p>
                    The Sprite Sheet is a strategy for storing multiple sprites in a single image. This is useful for reducing the number of shaders needed to render a scene.

                </p>
                <h5>Spritesheet.png (texture1):</h5>

                <img src="/textures/spritesheet.png" style="width:100%;   image-rendering: pixelated; " alt="Doom Enemy Texture">

                      <h5>Vertex Shader Code:</h5>
                        <pre> 
                            <code>
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
                            </code>
                        </pre>

                        <h5>Fragment Shader Code:</h5>
                        <pre> 
                            <code>
uniform vec3 pos;
uniform vec2 spriteSelected;
uniform vec2 spriteSize;
uniform sampler2D texture1;
varying vec2 vUv;
void main() {
    vec2 uv = vUv;
                                    
    vec4 tex = texture2D( texture1, uv / spriteSize + (spriteSelected / spriteSize) );
                    
    // if the alpha is 0, discard this fragment
    if (tex.a == 0.0) discard;
                      
    gl_FragColor = tex;
}
                            </code>
                        </pre>
                        <h5>Block Selection: </h5>
                        <pre>
                            <code>
enum BlockType {
    Stone = 0,
    Wood = 1,
    Brick = 2,
}
</code>
</pre>

                    
                    <img src="/textures/Screenshot.png" style="width:100%; " alt="Code screenshot" />
                    <p>Set the spriteSelected uniform using the enum value </p>
                        <h5>Real World Example:</h5>
                        <p>Minecraft uses this concept for its block textures that makeup the entire game</p>
                        <img src="/textures/minecraft.png" style="width:100%" alt="Doom Enemy Texture">
                        <img src="/textures/minecraftInGame.gif" style="width:100%" alt="Doom Enemy Texture">
                        <!-- sources -->
                        <h5>Sources:</h5>
                        <ul>
                            <li><a href="https://support.bluestacks.com/hc/vi/articles/6462696716301-C%C3%A1ch-%C4%91%E1%BB%83-c%C3%B3-tr%E1%BA%A3i-nghi%E1%BB%87m-ch%C6%A1i-game-gi%E1%BB%91ng-PC-trong-Minecraft-tr%C3%AAn-BlueStacks-5">Minecraft In-Game (From BlueStacks)</a></li>
                            <li><a href="https://www.nicepng.com/ourpic/u2w7e6w7i1i1i1i1_blockcss-new-minecraft-block-sprite-sheet/">Minecraft Sprite Sheet (From NicePNG)</a></li>
                        </ul> 

            </div>

        </div>
        <div v-if="demo == 'shader'">
            <h2>Shader Colored Textures</h2>
            <div>
                <p>
                    The Shader Colored Textures is a strategy for coloring a texture in the shader. This is useful for reducing the number of textures needed to render a scene. It allows for more dynamic coloring of textures and reuse of textures. In this example, we color a door texture to be red, green, or blue.

                </p>door.png (texture1):</h5>

                <img src="/textures/door.png" style="width:100%;   image-rendering: pixelated; " alt="Doom Enemy Texture">

                      <h5>Vertex Shader Code:</h5>
                        <pre> 
                            <code>
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
                            </code>
                        </pre>

                        <h5>Fragment Shader Code:</h5>

                        <pre>
                            <code>
uniform vec3 pos;
uniform vec3 spriteColor;
uniform sampler2D texture1;
varying vec2 vUv;
void main() {
    vec2 uv = vUv;
                                    
    vec4 tex = texture2D( texture1, uv);
                    
    // if the alpha is 0, discard this fragment
    if (tex.a == 0.0) discard;
                      
    gl_FragColor = tex * vec4(spriteColor, 1.0);
}
                            </code>
                        </pre>
                  
                    </div> 
                </div>
    </body>

    <script> 
    
        const app = Vue.createApp({
            data() {
                return {
                    demo: 'fire',
                }
            }
        })
        app.mount('#app')
    
    </script>
    <style>
        #overlay {
            position: absolute;
          
          
            z-index: 100;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;

            overflow-y: scroll;
       
        }
        #app{
            width: 30%;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 1em;
            border-radius: 1em;
            color: white;
            margin: 1em;
        
            
        }
        pre {
            background-color: #000;
            color: #fff;
            padding: .1em;
            border-radius: 1em;
        }

        code {
            white-space: pre-wrap;
            font-size: smaller;


        }
        a {
            color: white;
        }
    </style>
    
</html>
